<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Upload Database</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background: linear-gradient(135deg, #fdfbfb, #ebedee);
      text-align: center;
      padding: 50px;
    }
    h2 { color: #2c3e50; }

    /* ‡∏ã‡πà‡∏≠‡∏ô input file ‡πÄ‡∏î‡∏¥‡∏° */
    input[type="file"] {
      display: none;
    }

    /* ‡∏õ‡∏∏‡πà‡∏° custom */
    .custom-file-upload {
      display: inline-block;
      padding: 12px 25px;
      border-radius: 30px;
      background: #3498db;
      color: white;
      cursor: pointer;
      font-size: 14px;
      transition: 0.3s;
    }
    .custom-file-upload:hover {
      background: #2980b9;
    }

    #status {
      margin-top: 20px;
      font-weight: bold;
      color: green;
    }
    button {
      margin-top: 20px;
      padding: 12px 20px;
      border-radius: 25px;
      border: none;
      background: #3498db;
      color: white;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover { background: #2980b9; }
  </style>
</head>
<body>
  <h2>‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå Excel ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡πá‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h2>

  <!-- ‡∏õ‡∏∏‡πà‡∏° custom ‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏±‡∏ö input file -->
  <label for="fileInput" class="custom-file-upload">üìÇ ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå Excel</label>
  <input type="file" id="fileInput" accept=".xlsx">

  <p id="status"></p>

  <button onclick="goToUser()">‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</button>
  <button onclick="clearData()">‡∏•‡πâ‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>

<script>
  function clearData() {
    localStorage.removeItem("excelData");
    alert("‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ñ‡∏π‡∏Å‡∏•‡πâ‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÑ‡∏î‡πâ‡∏à‡∏ô‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏∞‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏´‡∏°‡πà");
  }

  document.getElementById("fileInput").addEventListener("change", async (event) => {
    const file = event.target.files[0];
    if (!file) return;

    const arrayBuffer = await file.arrayBuffer();
    const workbook = XLSX.read(arrayBuffer, {type: "array"});
    const sheetName = workbook.SheetNames[0];
    const worksheet = workbook.Sheets[sheetName];
    const excelData = XLSX.utils.sheet_to_json(worksheet, {header:1});

    localStorage.removeItem("excelData");
    localStorage.setItem("excelData", JSON.stringify(excelData));

    document.getElementById("status").innerText = "‚úÖ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß";
  });

  function goToUser() {
    window.location.href = "index.html";
  }
</script>
</body>
</html>
